# 5.3 用户和用户组管理的命令

## 5.3.1 用户的添加

```shell
useradd [选项] 用户名
```

选项：
\-u UID：手动指定用户UID（不小于500）
\-d 主目录：必须使用绝对路径
\-c 用户说明
\-g 组名：手动指定用户的初始组。
\-G 组名：指定用户的附加组。
\-s shell：手动指定用户的登录shell。默认为/bin/bash
\-e 日期：指定用户的失效日期
\-o 允许创建的用户UID相同
\-m 建立用户时强制建立用户的主目录。在建立系统用户时，该选项是默认的。
\-r 创建系统用户。

## 5.3.2 密码配置命令

```shell
passwd [选项] 用户名
```

选项：
\-S：查询用户密码的状态，仅root可用 
\-l：暂时锁定用户，仅root可用
\-u：解锁用户，仅root可用
\--stdin：可以将通过管道符输出的数据作为用户的密码；主要在批量添加用户时使用。
\-n：设置该用户修改密码后，多长时间不能再次修改密码
\-x：设置该用户的密码有效期
\-w：设置用户密码过期前的警告天数
\-i：设置用户密码失效日期

普通用户只能用passwd命令修改自己的密码，而且需要先输入自己的旧密码。

## 5.3.3修改用户信息命令

```shell
usermod [选项] 用户名
```

选项：
\-c：修改用户的说明信息
\-d：修改用户的主目录
\-e：修改用户的失效日期
\-g：修改用户的初始组
\-u：修改用户的ID
\-G：修改用户的附加组
\-l：修改用户名称
\-L：临时锁定用户
\-U：解锁用户
\-s shell：修改用户的登录shell

## 5.3.4 修改用户密码状态命令

```shell
chage [选项] 用户名
```

选项：
\-l：列出用户的详细密码状态
\-d：修改最后一次修改密码的日期
\-m：修改密码最短保留的天数
\-M：修改密码的有效期
\-W：修改密码到期前的警告天数
\-i：修改密码过期后的宽限天数
\-E：修改账号失效日期

## 5.3.5 删除用户命令

```shell
userdel -r 用户名
```

-r 选项表示在删除用户的同事删除用户和用户的家目录

## 5.3.6 查看用户的UID和GID命令

```shell
id 用户名
```

结果中 groups 是用户所在组，既可以看到初始组，如果有附加组，则也可以看到附加组。

## 5.3.7 用户切换命令

```shell
su [选项] 用户名
```

普通用户切换到其他身份时，需要知晓对方密码；root用户则无需。

选项：
\-：当前用户不仅切换为指定用户的身份，同时所用的工作环境也切换，可以省略用户名，默认切换为root。
\-l：同上，但后面需要添加欲切换的使用者账号。
\-p：表示切换为指定用户的身份，但是不改变当前的工作环境。
\-m：同-p
\-c：仅切换用户并执行一次命令，执行后自动切换回来，该选项后通常会带有要执行的命令。

## 5.3.8 用户组管理命令

```shell
groupadd [选项] 组名
```

选项：
\-g GID:指定组ID
\-r:创建系统群组

```shell
groupmod [选项] 组名
```

\-g GID:修改组ID
\-n 新组名:修改组名

```shell
groupdel 组名
```

无法删除用户的初始组

```shell
gpasswd [选项] 组名
```

选项：
空：表示给组设置密码，仅root可用
\-A user1,...:将群组的控制权交给user1等用户管理，仅root可用
\-M user1,...:将user1等用户加入此组，仅root
\-r:移除组的密码，仅root
\-R:让组的密码失效，仅root
\-a user:让user用户加入组
\-d user:将user用户从组中移除

```shell
newgrp 组名
```

newgrp命令可以从用户的附加组中选择一个群组，作为用户新的初始组。
